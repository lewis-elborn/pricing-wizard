{"version":3,"file":"view.js","mappings":"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","sources":["webpack://pricing-wizard/./src/view.js"],"sourcesContent":["const $ = jQuery;\n\nclass MultistepForm {\n    constructor() {\n        this.steps = $('.pw-step');\n        this.buttons = $('.pw-button');\n        this.inputs = $('.pw-container').find(':input');\n        this.columns = $('.pw-column');\n        this.contactForm = $('.wpcf7');\n        this.spinner = $('.pw-spinner');\n        this.errors = $('.pw-errors');\n\n        this.bindEvents();\n    }\n\n    bindEvents() {\n        this.buttons.on('click', eventObject => this.handleStepChange(eventObject));\n\n        this.inputs.on('keyup change', eventObject => this.updateContactFormInputValues(eventObject));\n        \n        this.contactForm.on('wpcf7submit', () => {\n            this.changeStep(6);\n        });\n    }\n\n    handleStepChange(eventObject) {\n        const button = $(eventObject.target);\n        const direction = button.data('direction');\n        const stepContainer = button.closest('.pw-step')\n        const currentStep = stepContainer.data('step');\n        const ajaxAction = stepContainer.data('ajax-action');\n        const nextStep = direction === 'next' ? currentStep+1 : currentStep-1;\n\n        if(!direction) {\n            return;\n        }\n\n        this.spinner.show();\n\n        switch(ajaxAction) {\n            case 'verifyPostcode':\n                this.verifyPostcode(stepContainer, (response) => {\n                    if(response.success) {\n                        this.changeHourlyPrices(response.prices);\n                        this.changeStep(nextStep);\n                    } else {\n                        this.addError('Postcode is not valid.');\n                    }\n                });\n                break;\n            default:\n                this.changeStep(nextStep);\n                break;\n        }\n    }\n\n    updateContactFormInputValues(eventObject) {\n        const input = $(eventObject.target);\n        const contactFormName = input.data('cf-name');\n\n        if(contactFormName) {\n            const contactFormInput = $('.pw-container').find(`[name=\"${contactFormName}\"]`);\n            contactFormInput.val(input.val());\n        }\n    }\n\n    changeStep(stepIndex) {\n        this.clearErrors();\n        this.spinner.hide();\n        this.steps.hide();\n\n        this.steps.each((index, element) => {\n            const step = $(element);\n            index !== stepIndex ? step.hide() : step.show();\n        });\n    }\n\n    changeHourlyPrices(prices) {\n        this.columns.each((index, element) => {\n            $(element).find('.pw-column__price').text(prices[index]);\n            $(element).find('.pw-column__price').text(prices[index]);\n            $(element).find('input').val(prices[index]);\n        });\n    }\n\n    addError(error) {\n        this.spinner.hide();\n        this.errors.show();\n        this.errors.append(`<p>${error}</p>`);\n    }\n\n    clearErrors() {\n        this.errors.hide();\n        this.errors.empty();\n    }\n\n    verifyPostcode(step, callback) {\n        const postcode = step.find('[id=\"postCode\"]').val();\n\n        $.ajax({\n            type: \"POST\",\n            dataType: \"json\",\n            url: data.ajax_url,\n            data: {\n                action: 'apwb_ideal_postcode_lookup',\n                postcode,\n            },\n            success: response => {\n                callback(response);\n            },\n            error: response => {\n                callback(response);\n            }\n        });\n    }\n}\n\n$(() => {\n    new MultistepForm();\n});"],"names":["$","jQuery","MultistepForm","constructor","steps","buttons","inputs","find","columns","contactForm","spinner","errors","bindEvents","on","eventObject","handleStepChange","updateContactFormInputValues","changeStep","button","target","direction","data","stepContainer","closest","currentStep","ajaxAction","nextStep","show","verifyPostcode","response","success","changeHourlyPrices","prices","addError","input","contactFormName","contactFormInput","val","stepIndex","clearErrors","hide","each","index","element","step","text","error","append","empty","callback","postcode","ajax","type","dataType","url","ajax_url","action"],"sourceRoot":""}